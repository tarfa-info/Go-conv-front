/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
"use strict";
import sha1 from 'crypto-js/sha1';
import Base64 from 'crypto-js/enc-base64';
import { passwordDigest } from '../utils';
var /** @type {?} */ validPasswordTypes = ['PasswordDigest', 'PasswordText'];
/**
 * @param {?} username
 * @param {?} password
 * @param {?} options
 * @return {?}
 */
export function WSSecurity(username, password, options) {
    options = options || {};
    this._username = username;
    this._password = password;
    //must account for backward compatibility for passwordType String param as well as object options defaults: passwordType = 'PasswordText', hasTimeStamp = true
    if (typeof options === 'string') {
        this._passwordType = options ? options : 'PasswordText';
        options = {};
    }
    else {
        this._passwordType = options.passwordType ? options.passwordType : 'PasswordText';
    }
    if (validPasswordTypes.indexOf(this._passwordType) === -1) {
        this._passwordType = 'PasswordText';
    }
    this._hasTimeStamp = options.hasTimeStamp || typeof options.hasTimeStamp === 'boolean' ? !!options.hasTimeStamp : true;
    /*jshint eqnull:true */
    if (options.hasNonce != null) {
        this._hasNonce = !!options.hasNonce;
    }
    this._hasTokenCreated = options.hasTokenCreated || typeof options.hasTokenCreated === 'boolean' ? !!options.hasTokenCreated : true;
    if (options.actor != null) {
        this._actor = options.actor;
    }
    if (options.mustUnderstand != null) {
        this._mustUnderstand = !!options.mustUnderstand;
    }
}
WSSecurity.prototype.toXML = function () {
    /**
     * @param {?} d
     * @return {?}
     */
    function getDate(d) {
        /**
         * @param {?} n
         * @return {?}
         */
        function pad(n) {
            return n < 10 ? '0' + n : n;
        }
        return d.getUTCFullYear() + '-'
            + pad(d.getUTCMonth() + 1) + '-'
            + pad(d.getUTCDate()) + 'T'
            + pad(d.getUTCHours()) + ':'
            + pad(d.getUTCMinutes()) + ':'
            + pad(d.getUTCSeconds()) + 'Z';
    }
    var /** @type {?} */ now = new Date();
    var /** @type {?} */ created = getDate(now);
    var /** @type {?} */ timeStampXml = '';
    if (this._hasTimeStamp) {
        var /** @type {?} */ expires = getDate(new Date(now.getTime() + (1000 * 600)));
        timeStampXml = "<wsu:Timestamp wsu:Id=\"Timestamp-" + created + "\">" +
            "<wsu:Created>" + created + "</wsu:Created>" +
            "<wsu:Expires>" + expires + "</wsu:Expires>" +
            "</wsu:Timestamp>";
    }
    var /** @type {?} */ password, /** @type {?} */ nonce;
    if (this._hasNonce || this._passwordType !== 'PasswordText') {
        // nonce = base64 ( sha1 ( created + random ) )
        // var nHash = crypto.createHash('sha1');
        // nHash.update(created + Math.random());
        // nonce = nHash.digest('base64');
        nonce = Base64.stringify(sha1(created + Math.random(), ''));
    }
    if (this._passwordType === 'PasswordText') {
        password = "<wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\">" + this._password + "</wsse:Password>";
        if (nonce) {
            password += "<wsse:Nonce EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\">" + nonce + "</wsse:Nonce>";
        }
    }
    else {
        password = "<wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest\">" + passwordDigest(nonce, created, this._password) + "</wsse:Password>" +
            "<wsse:Nonce EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\">" + nonce + "</wsse:Nonce>";
    }
    return "<wsse:Security " + (this._actor ? "soap:actor=\"" + this._actor + "\" " : "") +
        (this._mustUnderstand ? "soap:mustUnderstand=\"1\" " : "") +
        "xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">" +
        timeStampXml +
        "<wsse:UsernameToken xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\" wsu:Id=\"SecurityToken-" + created + "\">" +
        "<wsse:Username>" + this._username + "</wsse:Username>" +
        password +
        (this._hasTokenCreated ? "<wsu:Created>" + created + "</wsu:Created>" : "") +
        "</wsse:UsernameToken>" +
        "</wsse:Security>";
};
// module.exports = WSSecurity;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiV1NTZWN1cml0eS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1zb2FwLyIsInNvdXJjZXMiOlsibGliL3NvYXAvc2VjdXJpdHkvV1NTZWN1cml0eS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsWUFBWSxDQUFDO0FBR2IsT0FBTyxJQUFJLE1BQU0sZ0JBQWdCLENBQUM7QUFDbEMsT0FBTyxNQUFNLE1BQU0sc0JBQXNCLENBQUM7QUFHMUMsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUUxQyxxQkFBSSxrQkFBa0IsR0FBRyxDQUFDLGdCQUFnQixFQUFFLGNBQWMsQ0FBQyxDQUFDOzs7Ozs7O0FBRTVELE1BQU0scUJBQXFCLFFBQVEsRUFBRSxRQUFRLEVBQUUsT0FBTztJQUNwRCxPQUFPLEdBQUcsT0FBTyxJQUFJLEVBQUUsQ0FBQztJQUN4QixJQUFJLENBQUMsU0FBUyxHQUFHLFFBQVEsQ0FBQztJQUMxQixJQUFJLENBQUMsU0FBUyxHQUFHLFFBQVEsQ0FBQzs7SUFFMUIsRUFBRSxDQUFDLENBQUMsT0FBTyxPQUFPLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQztRQUNoQyxJQUFJLENBQUMsYUFBYSxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUM7UUFDeEQsT0FBTyxHQUFHLEVBQUUsQ0FBQztLQUNkO0lBQUMsSUFBSSxDQUFDLENBQUM7UUFDTixJQUFJLENBQUMsYUFBYSxHQUFHLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQztLQUNuRjtJQUVELEVBQUUsQ0FBQyxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzFELElBQUksQ0FBQyxhQUFhLEdBQUcsY0FBYyxDQUFDO0tBQ3JDO0lBRUQsSUFB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YSxLQUFLLGNBQWMsQ0FBQyxDQUFDLENBQUM7UUFDMUMsUUFBUSxHQUFHLDBIQUEwSCxHQUFHLElBQUksQ0FBQyxTQUFTLEdBQUcsa0JBQWtCLENBQUM7UUFDNUssRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztZQUNWLFFBQVEsSUFBSSw4SEFBOEgsR0FBRyxLQUFLLEdBQUcsZUFBZSxDQUFDO1NBQ3RLO0tBQ0Y7SUFBQyxJQUFJLENBQUMsQ0FBQztRQUNOLFFBQVEsR0FBRyw0SEFBNEgsR0FBRyxjQUFjLENBQUMsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsa0JBQWtCO1lBQzNNLDhIQUE4SCxHQUFHLEtBQUssR0FBRyxlQUFlLENBQUM7S0FDNUo7SUFFRCxNQUFNLENBQUMsaUJBQWlCLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUNuRixDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLDRCQUE0QixDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7UUFDMUQsb01BQW9NO1FBQ3BNLFlBQVk7UUFDWiw4SUFBOEksR0FBRyxPQUFPLEdBQUcsS0FBSztRQUNoSyxpQkFBaUIsR0FBRyxJQUFJLENBQUMsU0FBUyxHQUFHLGtCQUFrQjtRQUN2RCxRQUFRO1FBQ1IsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLGVBQWUsR0FBRyxPQUFPLEdBQUcsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUMzRSx1QkFBdUI7UUFDdkIsa0JBQWtCLENBQUM7Q0FDdEIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG4vLyB2YXIgY3J5cHRvID0gcmVxdWlyZSgnY3J5cHRvJyk7XG5pbXBvcnQgc2hhMSBmcm9tICdjcnlwdG8tanMvc2hhMSc7XG5pbXBvcnQgQmFzZTY0IGZyb20gJ2NyeXB0by1qcy9lbmMtYmFzZTY0JztcblxuLy8gdmFyIHBhc3N3b3JkRGlnZXN0ID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5wYXNzd29yZERpZ2VzdDtcbmltcG9ydCB7IHBhc3N3b3JkRGlnZXN0IH0gZnJvbSAnLi4vdXRpbHMnO1xuXG52YXIgdmFsaWRQYXNzd29yZFR5cGVzID0gWydQYXNzd29yZERpZ2VzdCcsICdQYXNzd29yZFRleHQnXTtcblxuZXhwb3J0IGZ1bmN0aW9uIFdTU2VjdXJpdHkodXNlcm5hbWUsIHBhc3N3b3JkLCBvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICB0aGlzLl91c2VybmFtZSA9IHVzZXJuYW1lO1xuICB0aGlzLl9wYXNzd29yZCA9IHBhc3N3b3JkO1xuICAvL211c3QgYWNjb3VudCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSBmb3IgcGFzc3dvcmRUeXBlIFN0cmluZyBwYXJhbSBhcyB3ZWxsIGFzIG9iamVjdCBvcHRpb25zIGRlZmF1bHRzOiBwYXNzd29yZFR5cGUgPSAnUGFzc3dvcmRUZXh0JywgaGFzVGltZVN0YW1wID0gdHJ1ZSAgIFxuICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7XG4gICAgdGhpcy5fcGFzc3dvcmRUeXBlID0gb3B0aW9ucyA/IG9wdGlvbnMgOiAnUGFzc3dvcmRUZXh0JztcbiAgICBvcHRpb25zID0ge307XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5fcGFzc3dvcmRUeXBlID0gb3B0aW9ucy5wYXNzd29yZFR5cGUgPyBvcHRpb25zLnBhc3N3b3JkVHlwZSA6ICdQYXNzd29yZFRleHQnO1xuICB9XG5cbiAgaWYgKHZhbGlkUGFzc3dvcmRUeXBlcy5pbmRleE9mKHRoaXMuX3Bhc3N3b3JkVHlwZSkgPT09IC0xKSB7XG4gICAgdGhpcy5fcGFzc3dvcmRUeXBlID0gJ1Bhc3N3b3JkVGV4dCc7XG4gIH1cblxuICB0aGlzLl9oYXNUaW1lU3RhbXAgPSBvcHRpb25zLmhhc1RpbWVTdGFtcCB8fCB0eXBlb2Ygb3B0aW9ucy5oYXNUaW1lU3RhbXAgPT09ICdib29sZWFuJyA/ICEhb3B0aW9ucy5oYXNUaW1lU3RhbXAgOiB0cnVlO1xuICAvKmpzaGludCBlcW51bGw6dHJ1ZSAqL1xuICBpZiAob3B0aW9ucy5oYXNOb25jZSAhPSBudWxsKSB7XG4gICAgdGhpcy5faGFzTm9uY2UgPSAhIW9wdGlvbnMuaGFzTm9uY2U7XG4gIH1cbiAgdGhpcy5faGFzVG9rZW5DcmVhdGVkID0gb3B0aW9ucy5oYXNUb2tlbkNyZWF0ZWQgfHwgdHlwZW9mIG9wdGlvbnMuaGFzVG9rZW5DcmVhdGVkID09PSAnYm9vbGVhbicgPyAhIW9wdGlvbnMuaGFzVG9rZW5DcmVhdGVkIDogdHJ1ZTtcbiAgaWYgKG9wdGlvbnMuYWN0b3IgIT0gbnVsbCkge1xuICAgIHRoaXMuX2FjdG9yID0gb3B0aW9ucy5hY3RvcjtcbiAgfVxuICBpZiAob3B0aW9ucy5tdXN0VW5kZXJzdGFuZCAhPSBudWxsKSB7XG4gICAgdGhpcy5fbXVzdFVuZGVyc3RhbmQgPSAhIW9wdGlvbnMubXVzdFVuZGVyc3RhbmQ7XG4gIH1cbn1cblxuV1NTZWN1cml0eS5wcm90b3R5cGUudG9YTUwgPSBmdW5jdGlvbigpIHtcbiAgLy8gYXZvaWQgZGVwZW5kZW5jeSBvbiBkYXRlIGZvcm1hdHRpbmcgbGlicmFyaWVzXG4gIGZ1bmN0aW9uIGdldERhdGUoZCkge1xuICAgIGZ1bmN0aW9uIHBhZChuKSB7XG4gICAgICByZXR1cm4gbiA8IDEwID8gJzAnICsgbiA6IG47XG4gICAgfVxuICAgIHJldHVybiBkLmdldFVUQ0Z1bGxZZWFyKCkgKyAnLSdcbiAgICAgICsgcGFkKGQuZ2V0VVRDTW9udGgoKSArIDEpICsgJy0nXG4gICAgICArIHBhZChkLmdldFVUQ0RhdGUoKSkgKyAnVCdcbiAgICAgICsgcGFkKGQuZ2V0VVRDSG91cnMoKSkgKyAnOidcbiAgICAgICsgcGFkKGQuZ2V0VVRDTWludXRlcygpKSArICc6J1xuICAgICAgKyBwYWQoZC5nZXRVVENTZWNvbmRzKCkpICsgJ1onO1xuICB9XG4gIHZhciBub3cgPSBuZXcgRGF0ZSgpO1xuICB2YXIgY3JlYXRlZCA9IGdldERhdGUobm93KTtcbiAgdmFyIHRpbWVTdGFtcFhtbCA9ICcnO1xuICBpZiAodGhpcy5faGFzVGltZVN0YW1wKSB7XG4gICAgdmFyIGV4cGlyZXMgPSBnZXREYXRlKCBuZXcgRGF0ZShub3cuZ2V0VGltZSgpICsgKDEwMDAgKiA2MDApKSApO1xuICAgIHRpbWVTdGFtcFhtbCA9IFwiPHdzdTpUaW1lc3RhbXAgd3N1OklkPVxcXCJUaW1lc3RhbXAtXCIrY3JlYXRlZCtcIlxcXCI+XCIgK1xuICAgICAgXCI8d3N1OkNyZWF0ZWQ+XCIrY3JlYXRlZCtcIjwvd3N1OkNyZWF0ZWQ+XCIgK1xuICAgICAgXCI8d3N1OkV4cGlyZXM+XCIrZXhwaXJlcytcIjwvd3N1OkV4cGlyZXM+XCIgK1xuICAgICAgXCI8L3dzdTpUaW1lc3RhbXA+XCI7XG4gIH1cblxuICB2YXIgcGFzc3dvcmQsIG5vbmNlO1xuICBpZiAodGhpcy5faGFzTm9uY2UgfHwgdGhpcy5fcGFzc3dvcmRUeXBlICE9PSAnUGFzc3dvcmRUZXh0Jykge1xuICAgIC8vIG5vbmNlID0gYmFzZTY0ICggc2hhMSAoIGNyZWF0ZWQgKyByYW5kb20gKSApXG4gICAgLy8gdmFyIG5IYXNoID0gY3J5cHRvLmNyZWF0ZUhhc2goJ3NoYTEnKTtcbiAgICAvLyBuSGFzaC51cGRhdGUoY3JlYXRlZCArIE1hdGgucmFuZG9tKCkpO1xuICAgIC8vIG5vbmNlID0gbkhhc2guZGlnZXN0KCdiYXNlNjQnKTtcbiAgICBub25jZSA9IEJhc2U2NC5zdHJpbmdpZnkoc2hhMShjcmVhdGVkICsgTWF0aC5yYW5kb20oKSwgJycpKTtcbiAgfVxuICBpZiAodGhpcy5fcGFzc3dvcmRUeXBlID09PSAnUGFzc3dvcmRUZXh0Jykge1xuICAgIHBhc3N3b3JkID0gXCI8d3NzZTpQYXNzd29yZCBUeXBlPVxcXCJodHRwOi8vZG9jcy5vYXNpcy1vcGVuLm9yZy93c3MvMjAwNC8wMS9vYXNpcy0yMDA0MDEtd3NzLXVzZXJuYW1lLXRva2VuLXByb2ZpbGUtMS4wI1Bhc3N3b3JkVGV4dFxcXCI+XCIgKyB0aGlzLl9wYXNzd29yZCArIFwiPC93c3NlOlBhc3N3b3JkPlwiO1xuICAgIGlmIChub25jZSkge1xuICAgICAgcGFzc3dvcmQgKz0gXCI8d3NzZTpOb25jZSBFbmNvZGluZ1R5cGU9XFxcImh0dHA6Ly9kb2NzLm9hc2lzLW9wZW4ub3JnL3dzcy8yMDA0LzAxL29hc2lzLTIwMDQwMS13c3Mtc29hcC1tZXNzYWdlLXNlY3VyaXR5LTEuMCNCYXNlNjRCaW5hcnlcXFwiPlwiICsgbm9uY2UgKyBcIjwvd3NzZTpOb25jZT5cIjtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcGFzc3dvcmQgPSBcIjx3c3NlOlBhc3N3b3JkIFR5cGU9XFxcImh0dHA6Ly9kb2NzLm9hc2lzLW9wZW4ub3JnL3dzcy8yMDA0LzAxL29hc2lzLTIwMDQwMS13c3MtdXNlcm5hbWUtdG9rZW4tcHJvZmlsZS0xLjAjUGFzc3dvcmREaWdlc3RcXFwiPlwiICsgcGFzc3dvcmREaWdlc3Qobm9uY2UsIGNyZWF0ZWQsIHRoaXMuX3Bhc3N3b3JkKSArIFwiPC93c3NlOlBhc3N3b3JkPlwiICtcbiAgICAgIFwiPHdzc2U6Tm9uY2UgRW5jb2RpbmdUeXBlPVxcXCJodHRwOi8vZG9jcy5vYXNpcy1vcGVuLm9yZy93c3MvMjAwNC8wMS9vYXNpcy0yMDA0MDEtd3NzLXNvYXAtbWVzc2FnZS1zZWN1cml0eS0xLjAjQmFzZTY0QmluYXJ5XFxcIj5cIiArIG5vbmNlICsgXCI8L3dzc2U6Tm9uY2U+XCI7XG4gIH1cblxuICByZXR1cm4gXCI8d3NzZTpTZWN1cml0eSBcIiArICh0aGlzLl9hY3RvciA/IFwic29hcDphY3Rvcj1cXFwiXCIgKyB0aGlzLl9hY3RvciArIFwiXFxcIiBcIiA6IFwiXCIpICtcbiAgICAodGhpcy5fbXVzdFVuZGVyc3RhbmQgPyBcInNvYXA6bXVzdFVuZGVyc3RhbmQ9XFxcIjFcXFwiIFwiIDogXCJcIikgK1xuICAgIFwieG1sbnM6d3NzZT1cXFwiaHR0cDovL2RvY3Mub2FzaXMtb3Blbi5vcmcvd3NzLzIwMDQvMDEvb2FzaXMtMjAwNDAxLXdzcy13c3NlY3VyaXR5LXNlY2V4dC0xLjAueHNkXFxcIiB4bWxuczp3c3U9XFxcImh0dHA6Ly9kb2NzLm9hc2lzLW9wZW4ub3JnL3dzcy8yMDA0LzAxL29hc2lzLTIwMDQwMS13c3Mtd3NzZWN1cml0eS11dGlsaXR5LTEuMC54c2RcXFwiPlwiICtcbiAgICB0aW1lU3RhbXBYbWwgK1xuICAgIFwiPHdzc2U6VXNlcm5hbWVUb2tlbiB4bWxuczp3c3U9XFxcImh0dHA6Ly9kb2NzLm9hc2lzLW9wZW4ub3JnL3dzcy8yMDA0LzAxL29hc2lzLTIwMDQwMS13c3Mtd3NzZWN1cml0eS11dGlsaXR5LTEuMC54c2RcXFwiIHdzdTpJZD1cXFwiU2VjdXJpdHlUb2tlbi1cIiArIGNyZWF0ZWQgKyBcIlxcXCI+XCIgK1xuICAgIFwiPHdzc2U6VXNlcm5hbWU+XCIgKyB0aGlzLl91c2VybmFtZSArIFwiPC93c3NlOlVzZXJuYW1lPlwiICtcbiAgICBwYXNzd29yZCArXG4gICAgKHRoaXMuX2hhc1Rva2VuQ3JlYXRlZCA/IFwiPHdzdTpDcmVhdGVkPlwiICsgY3JlYXRlZCArIFwiPC93c3U6Q3JlYXRlZD5cIiA6IFwiXCIpICtcbiAgICBcIjwvd3NzZTpVc2VybmFtZVRva2VuPlwiICtcbiAgICBcIjwvd3NzZTpTZWN1cml0eT5cIjtcbn07XG5cbi8vIG1vZHVsZS5leHBvcnRzID0gV1NTZWN1cml0eTtcbiJdfQ==